<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Riba Run â€“ Minimal JS Port</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
      background: #020617;
      font-family: monospace;
    }
    #gameCanvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      touch-action: none;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <script>
    // ---------- CONSTANTS ----------
    const GROUND_HEIGHT = 100;
    const PLAYER_WIDTH = 48;
    const PLAYER_HEIGHT = 56;
    const PLAYER_SLIDE_HEIGHT = 28;
    const GRAVITY = 0.55;
    const JUMP_FORCE = -14;
    const INITIAL_SPEED = 4.5;

    // ---------- GAME STATE ----------
    const game = {
      player: {
        x: 120,
        y: 0,
        velocityY: 0,
        isJumping: false,
        isSliding: false,
        slideTimer: 0,
      },
      groundY: 0,
      speed: INITIAL_SPEED,
      frameCount: 0,
      distance: 0,
      isRunning: true,
      coyoteCounter: 0,
    };

    const COYOTE_TIME = 8;

    let canvas, ctx;
    let animationId;

    // ---------- INIT ----------
    function init() {
      canvas = document.getElementById("gameCanvas");
      ctx = canvas.getContext("2d");

      resizeCanvas();
      window.addEventListener("resize", resizeCanvas);

      window.addEventListener("keydown", handleKeyDown);
      canvas.addEventListener("touchstart", handleTouch, { passive: false });

      gameLoop();
    }

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      game.groundY = canvas.height - GROUND_HEIGHT;
      game.player.y = game.groundY - PLAYER_HEIGHT;
    }

    // ---------- INPUT ----------
    function handleKeyDown(e) {
      if (e.code === "Space" || e.code === "ArrowUp") {
        e.preventDefault();
        handleJump();
      } else if (e.code === "ArrowDown") {
        e.preventDefault();
        handleSlide();
      }
    }

    function handleTouch(e) {
      e.preventDefault();
      const touch = e.touches[0];
      if (touch.clientY > window.innerHeight / 2) {
        handleSlide();
      } else {
        handleJump();
      }
    }

    function handleJump() {
      if (
        (!game.player.isJumping || game.coyoteCounter > 0) &&
        !game.player.isSliding &&
        game.isRunning
      ) {
        game.player.velocityY = JUMP_FORCE;
        game.player.isJumping = true;
        game.coyoteCounter = 0;
      }
    }

    function handleSlide() {
      if (!game.player.isJumping && !game.player.isSliding && game.isRunning) {
        game.player.isSliding = true;
        game.player.slideTimer = 35;
      }
    }

    // ---------- UPDATE ----------
    function update() {
      if (!game.isRunning) return;

      game.frameCount++;
      game.distance = Math.floor(game.frameCount * game.speed / 15);

      const p = game.player;

      // Slide timer
      if (p.isSliding) {
        p.slideTimer--;
        if (p.slideTimer <= 0) {
          p.isSliding = false;
        }
      }

      // Gravity + vertical movement
      p.velocityY += GRAVITY;
      p.y += p.velocityY;

      const playerHeight = p.isSliding ? PLAYER_SLIDE_HEIGHT : PLAYER_HEIGHT;

      if (p.y >= game.groundY - playerHeight) {
        p.y = game.groundY - playerHeight;
        p.velocityY = 0;
        p.isJumping = false;
        game.coyoteCounter = COYOTE_TIME;
      } else if (game.coyoteCounter > 0) {
        game.coyoteCounter--;
      }
    }

    // ---------- DRAW ----------
    function draw() {
      // Background gradient
      const bgGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      bgGradient.addColorStop(0, "#1a0a2e");
      bgGradient.addColorStop(0.3, "#2d1b4e");
      bgGradient.addColorStop(0.6, "#4a3070");
      bgGradient.addColorStop(1, "#6b4d8a");
      ctx.fillStyle = bgGradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Simple stars
      ctx.fillStyle = "#ffffff";
      for (let i = 0; i < 40; i++) {
        const starX = (i * 137 + game.frameCount * 0.1) % canvas.width;
        const starY = (i * 89) % (game.groundY - 80);
        ctx.fillRect(Math.floor(starX), Math.floor(starY), 2, 2);
      }

      // Ground
      ctx.fillStyle = "#c4a35a";
      ctx.fillRect(0, game.groundY, canvas.width, 8);
      ctx.fillStyle = "#8b7355";
      ctx.fillRect(0, game.groundY + 8, canvas.width, GROUND_HEIGHT);

      // Player (DEBUG rectangle for now)
      const p = game.player;
      const playerHeight = p.isSliding ? PLAYER_SLIDE_HEIGHT : PLAYER_HEIGHT;
      ctx.fillStyle = "#facc15"; // yellow
      ctx.fillRect(p.x, p.y, PLAYER_WIDTH, playerHeight);

      // Simple distance text
      ctx.fillStyle = "#ffffff";
      ctx.font = "16px monospace";
      ctx.fillText(`DIST: ${game.distance}m`, 20, 30);
    }

    // ---------- LOOP ----------
    function gameLoop() {
      update();
      draw();
      animationId = requestAnimationFrame(gameLoop);
    }

    window.addEventListener("load", init);
  </script>
</body>
</html>








    


